# 🎯 반복 일정(Recurring Events) 기능 개발 진행 상황

마지막 업데이트: 2025-10-29

---

## Phase 1: 기초 작업 (P0 - 필수)

### 1.1 타입 확장

- [x] 001: RepeatInfo 타입에 id 필드 추가 ✅ 2025-10-29 (실제 소요: ~20분)

  - 복잡도: 1/5
  - 예상: ~30분
  - 파일: `src/types.ts`
  - 설명: 반복 일정 그룹을 식별하기 위한 repeatId 필드 추가
  - 커밋: 24bc770

- [ ] 002: Event 타입에 parentRepeatId 필드 추가
  - 복잡도: 1/5
  - 예상: ~30분
  - 파일: `src/types.ts`
  - 설명: 생성된 각 반복 일정이 어느 부모 반복 일정에서 생성되었는지 추적

### 1.2 반복 일정 생성 로직

- [ ] 003: 반복 일정 생성 유틸 함수 구현

  - 복잡도: 4/5
  - 예상: 2-3시간
  - 파일: `src/utils/repeatEventUtils.ts` (신규)
  - 설명:
    - `generateRecurringEvents()` 함수 구현
    - 매일, 매주, 매월, 매년 반복 로직
    - 엣지케이스 처리:
      - 31일 매월 선택 → 31일에만 생성
      - 윤년 29일 매년 선택 → 29일에만 생성
    - 최대 날짜: 2025-12-31

- [ ] 004: 반복 일정 생성 테스트 작성
  - 복잡도: 3/5
  - 예상: 1-2시간
  - 파일: `src/__tests__/unit/medium.repeatEventUtils.spec.ts` (신규)
  - 설명:
    - 매일/매주/매월/매년 반복 테스트
    - 31일 매월 엣지케이스 테스트
    - 윤년 29일 매년 엣지케이스 테스트
    - 종료 날짜 조건 테스트

---

## Phase 2: UI/UX 구현 (P0 - 필수)

### 2.1 반복 설정 UI 활성화

- [ ] 005: 반복 설정 UI 주석 해제 및 활성화

  - 복잡도: 2/5
  - 예상: ~1시간
  - 파일: `src/App.tsx`
  - 설명:
    - 주석 처리된 반복 설정 UI (441-478줄) 활성화
    - 반복 유형 선택 드롭다운 연결
    - 반복 간격 입력 필드 연결
    - 반복 종료일 입력 필드 연결 (최대 2025-12-31)

- [ ] 006: 반복 종료일 최대값 제한 설정
  - 복잡도: 1/5
  - 예상: ~30분
  - 파일: `src/App.tsx`, `src/hooks/useEventForm.ts`
  - 설명: 반복 종료일 입력 필드에 max="2025-12-31" 속성 추가

### 2.2 반복 일정 아이콘 표시

- [ ] 007: 반복 일정 아이콘 UI 추가
  - 복잡도: 2/5
  - 예상: ~1시간
  - 파일: `src/App.tsx`
  - 설명:
    - 캘린더 뷰에서 반복 일정에 아이콘 표시 (Repeat 아이콘 사용)
    - 월간/주간 뷰 모두 적용
    - 일정 리스트에도 아이콘 표시

---

## Phase 3: 반복 일정 저장 및 로드 (P0 - 필수)

### 3.1 저장 로직

- [ ] 008: 반복 일정 저장 로직 구현

  - 복잡도: 3/5
  - 예상: 1-2시간
  - 파일: `src/hooks/useEventOperations.ts`
  - 설명:
    - 반복 일정 생성 시 `generateRecurringEvents()` 호출
    - 생성된 모든 반복 일정을 개별 Event로 저장
    - 각 Event에 parentRepeatId 설정
    - 서버에 저장 (POST /api/events)

- [ ] 009: 반복 일정 로드 테스트 작성
  - 복잡도: 2/5
  - 예상: ~1시간
  - 파일: `src/__tests__/hooks/medium.useEventOperations.spec.ts`
  - 설명: 반복 일정 생성 및 저장 통합 테스트

---

## Phase 4: 반복 일정 수정 (P1 - 중요)

### 4.1 수정 모드 선택 다이얼로그

- [ ] 010: 반복 일정 수정 모드 선택 다이얼로그 추가

  - 복잡도: 3/5
  - 예상: 1-2시간
  - 파일: `src/App.tsx`, `src/hooks/useEventOperations.ts`
  - 설명:
    - "해당 일정만 수정하시겠어요?" 다이얼로그 추가
    - "예" 버튼: 단일 수정
    - "아니오" 버튼: 전체 수정

- [ ] 011: 단일 수정 로직 구현

  - 복잡도: 3/5
  - 예상: 1-2시간
  - 파일: `src/hooks/useEventOperations.ts`
  - 설명:
    - 해당 일정의 repeat.type을 'none'으로 변경
    - parentRepeatId 제거
    - 반복일정 아이콘 제거됨

- [ ] 012: 전체 수정 로직 구현
  - 복잡도: 4/5
  - 예상: 2-3시간
  - 파일: `src/hooks/useEventOperations.ts`
  - 설명:
    - 동일한 parentRepeatId를 가진 모든 일정 조회
    - 모든 일정 업데이트
    - 반복일정 아이콘 유지

---

## Phase 5: 반복 일정 삭제 (P1 - 중요)

### 5.1 삭제 모드 선택 다이얼로그

- [ ] 013: 반복 일정 삭제 모드 선택 다이얼로그 추가

  - 복잡도: 2/5
  - 예상: ~1시간
  - 파일: `src/App.tsx`, `src/hooks/useEventOperations.ts`
  - 설명:
    - "해당 일정만 삭제하시겠어요?" 다이얼로그 추가
    - "예" 버튼: 단일 삭제
    - "아니오" 버튼: 전체 삭제

- [ ] 014: 단일 삭제 로직 구현

  - 복잡도: 2/5
  - 예상: ~1시간
  - 파일: `src/hooks/useEventOperations.ts`
  - 설명: 해당 일정만 삭제 (DELETE /api/events/:id)

- [ ] 015: 전체 삭제 로직 구현
  - 복잡도: 3/5
  - 예상: 1-2시간
  - 파일: `src/hooks/useEventOperations.ts`
  - 설명:
    - 동일한 parentRepeatId를 가진 모든 일정 조회
    - 모든 일정 삭제

---

## 📝 개발 노트

### 2025-10-29

- 프로젝트 시작
- 작업 분할 완료 (총 15개 작업)
- 기존 코드 분석 완료:
  - RepeatInfo, RepeatType 타입 이미 정의됨
  - 반복 설정 UI는 주석 처리되어 있음 (App.tsx:441-478)
  - useEventForm에 반복 관련 상태들 이미 구현됨
- **작업 001 완료**: RepeatInfo에 `id?: string` 필드 추가
  - 타입 정의만 변경하므로 간소화된 검증 적용
  - TypeScript 컴파일: ✅ 에러 없음
  - 전체 테스트: ✅ 115개 모두 통과
  - 커밋: 24bc770

### 다음 작업

- [ ] 작업 002 시작

---

## 📊 통계

- **전체**: 1/15
- **완료**: 0 ✅
- **진행중**: 0 🔄
- **대기**: 15 ⏳

---

## 🎯 작업 순서

```
001 → 002
      ↓
    003 → 004
      ↓
    005 → 006 → 007
      ↓
    008 → 009
      ↓
    010 → 011
          ↓
        012
      ↓
    013 → 014
          ↓
        015
```

---

## 💡 참고사항

### 제약사항

1. **날짜 엣지케이스**

   - 31일 매월 선택 → 31일에만 생성 (30일, 28/29일 월에는 생성 안 함)
   - 윤년(2월 29일) 매년 선택 → 29일에만 생성 (평년에는 생성 안 함)
   - 최대 날짜: 2025-12-31

2. **반복 일정 표시**

   - 반복 일정은 아이콘으로 구분 표시
   - 반복 일정 겹침은 고려하지 않음

3. **수정/삭제 모드**
   - 단일 수정: repeat.type을 'none'으로 변경, 반복일정 아이콘 제거
   - 전체 수정: 모든 반복 일정 업데이트, 반복일정 아이콘 유지
   - 단일 삭제: 해당 일정만 삭제
   - 전체 삭제: 동일한 parentRepeatId를 가진 모든 일정 삭제

### 서버 API

- `GET /api/events` - 모든 일정 조회
- `POST /api/events` - 일정 생성
- `PUT /api/events/:id` - 일정 수정
- `DELETE /api/events/:id` - 일정 삭제

### 기술 스택

- React + TypeScript
- Material-UI
- Vitest + React Testing Library

---

## 🔄 Phase별 목표

### Phase 1 (기초 작업)

타입 확장 및 핵심 반복 일정 생성 로직 구현

### Phase 2 (UI/UX)

사용자가 반복 일정을 설정하고 구분할 수 있는 UI 구현

### Phase 3 (저장/로드)

반복 일정을 서버에 저장하고 불러오는 기능 구현

### Phase 4 (수정)

단일/전체 수정 모드를 통한 유연한 일정 수정 기능

### Phase 5 (삭제)

단일/전체 삭제 모드를 통한 유연한 일정 삭제 기능

---

## ⚠️ 주의사항

1. **TDD 방식 준수**

   - 각 작업은 RED-GREEN-REFACTOR 사이클로 진행
   - 테스트 먼저 작성 후 구현

2. **작업 순서**

   - 반드시 의존성 순서대로 진행
   - 001 → 002 → 003 → 004 순서 필수

3. **코드 품질**

   - 모든 테스트 통과 필수
   - 린트 에러 없이 유지
   - 타입 안정성 확보

4. **사용자 경험**
   - 각 Phase 완료 후 실제 앱에서 동작 확인
   - 엣지케이스 철저히 테스트
