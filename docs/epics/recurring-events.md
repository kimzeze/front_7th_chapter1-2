# Epic: 반복 일정 관리 기능

## 목표

사용자가 반복적으로 발생하는 일정(매일, 매주, 매월, 매년)을 쉽게 생성하고 관리할 수 있는 기능 제공

## 비즈니스 가치

### 문제
- 매일/매주/매월 반복되는 일정을 일일이 수동으로 등록해야 하는 불편함
- 반복 일정을 일괄적으로 관리할 수 없어 수정/삭제 시 모든 인스턴스를 개별 처리해야 함
- 반복 일정과 단일 일정을 시각적으로 구분할 수 없음

### 해결책
- 반복 패턴을 한 번 설정하면 자동으로 여러 일정이 생성됨
- 반복 일정 그룹을 단위로 일괄 수정/삭제 가능
- 아이콘을 통해 반복 일정을 명확히 구분

### 사용자 가치
- ⏱️ 시간 절약: 반복 일정을 매번 수동 입력할 필요 없음
- 🎯 관리 효율: 반복 일정을 그룹으로 관리하여 실수 방지
- 👁️ 가시성: 반복 일정을 한눈에 파악 가능

## 범위

### 포함 사항
- [x] 반복 유형 선택 (매일, 매주, 매월, 매년)
- [x] 반복 일정 생성 및 저장
- [x] 반복 일정 아이콘 표시
- [x] 반복 종료 조건 설정 (특정 날짜까지)
- [x] 반복 일정 수정 (단일/전체)
- [x] 반복 일정 삭제 (단일/전체)

### 제외 사항
- ❌ 반복 횟수로 종료 (N회 후 종료)
- ❌ 반복 간격 커스터마이징 (2일마다, 3주마다 등) - interval은 항상 1
- ❌ 요일 선택 (매주 월/수/금만)
- ❌ 반복 일정 간 겹침 검사 (명세상 고려하지 않음)

## Stories

- Story 01: 반복 유형 선택 UI 구현
- Story 02: 반복 일정 자동 생성 로직
- Story 03: 반복 일정 아이콘 표시
- Story 04: 반복 종료 조건 설정
- Story 05: 반복 일정 수정 (단일/전체)
- Story 06: 반복 일정 삭제 (단일/전체)

## 제약사항

### 날짜 제약
- **31일 매월 반복**: 31일이 없는 달은 건너뜀 (2월, 4월, 6월, 9월, 11월)
  - 예: 1월 31일에 매월 반복 설정 → 2월 건너뜀 → 3월 31일 생성
- **윤년 2월 29일 매년 반복**: 평년에는 건너뜀
  - 예: 2024년 2월 29일에 매년 반복 설정 → 2025년 건너뜀 → 2026년 건너뜀 → 2028년 2월 29일 생성
- **최대 생성 날짜**: 2025-12-31까지만 생성
  - 예제 특성상 미래 일정을 제한하여 테스트 용이성 확보

### 기술적 제약
- **반복 일정 겹침 검사 제외**: 반복 일정끼리는 겹침 경고를 표시하지 않음
- **interval 고정**: 현재는 interval=1만 지원 (매 1일/1주/1월/1년)
- **기존 타입 활용**: 이미 정의된 RepeatInfo 타입 사용
- **repeatParentId**: 같은 반복 그룹의 모든 인스턴스는 동일한 repeatParentId를 가짐

### UI/UX 제약
- **반복 일정 수정 시 확인 대화상자**: "해당 일정만 수정하시겠어요?" (예/아니오)
  - 예: 단일 수정 → 반복 속성 제거 (repeat.type = 'none')
  - 아니오: 전체 수정 → 같은 repeatParentId를 가진 모든 일정 수정
- **반복 일정 삭제 시 확인 대화상자**: "해당 일정만 삭제하시겠어요?" (예/아니오)
  - 예: 단일 삭제
  - 아니오: 전체 삭제 → 같은 repeatParentId를 가진 모든 일정 삭제

## 성공 지표

### 기능 완성도
- [ ] 모든 반복 유형(daily, weekly, monthly, yearly)이 정상 작동
- [ ] 엣지 케이스(31일, 윤년 29일) 정확히 처리
- [ ] 반복 아이콘이 캘린더와 이벤트 리스트에 표시
- [ ] 단일/전체 수정 및 삭제가 정확히 동작

### 테스트 커버리지
- [ ] 반복 생성 로직 유닛 테스트 (엣지 케이스 포함)
- [ ] 수정/삭제 시나리오 통합 테스트
- [ ] 엣지 케이스 테스트 (31일, 윤년 29일, 2025-12-31 제한)

### 코드 품질
- [ ] 모든 테스트 통과
- [ ] 린트 에러 없음
- [ ] 타입 에러 없음
- [ ] TDD RED-GREEN-REFACTOR 사이클 준수

## 예상 일정

- **Phase 0: 문서화 및 계획** (Day 1)
  - Epic, Stories, TODO.md 작성

- **Phase 1-3: 핵심 기능** (Day 2-5)
  - 반복 생성 로직
  - UI 구현
  - 반복 종료 설정

- **Phase 4-5: 수정/삭제** (Day 6-7)
  - 단일/전체 수정
  - 단일/전체 삭제

- **Phase 6: 통합 및 테스트** (Day 8)
  - 통합 테스트
  - 엣지 케이스 검증

## 참고 사항

### 기존 코드 활용
- `src/types.ts`: RepeatInfo, Event 타입 이미 정의됨
- `src/App.tsx` 라인 441-478: 반복 UI가 주석 처리되어 있음 (활성화 필요)
- `src/hooks/useEventForm.ts`: 반복 관련 state 이미 존재

### API 엔드포인트
- `POST /api/events`: 이벤트 생성
- `PUT /api/events/:id`: 이벤트 수정
- `DELETE /api/events/:id`: 이벤트 삭제
- 반복 일정은 **개별 이벤트로 저장**됨 (서버는 반복 로직을 모름)
