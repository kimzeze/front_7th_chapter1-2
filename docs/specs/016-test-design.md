# 016: 반복 일정 단일 삭제 로직 - 테스트 설계

작성일: 2025-10-30
작성자: Test Designer
상태: ✅ 승인됨

---

## 📌 개요

작업 016의 테스트 설계 문서입니다.

**중요**: 작업 015에서 이미 UI 동작을 검증하는 테스트를 작성했으므로, **새로운 테스트는 불필요**합니다.

대신, 기존 테스트가 계속 통과하는지 확인하여 회귀를 방지합니다.

---

## 🎯 테스트 전략

### 기존 테스트 활용

작업 015의 다음 테스트들이 이미 단일 삭제 동작을 검증합니다:

#### TC-003: "이 일정만" 버튼 클릭 시 삭제

```typescript
// "이 일정만" 버튼 클릭
// → deleteOption = 'single'
// → deleteEvent(id) 호출
// → 다이얼로그 닫힘
```

#### TC-005: "취소" 버튼 클릭 시 삭제 안 됨

```typescript
// "취소" 버튼 클릭
// → deleteOption = null
// → deleteEvent 호출 안 됨
// → 이벤트 여전히 존재
```

#### TC-007: 여러 번 단일 삭제

```typescript
// 3개 반복 이벤트 중 1개씩 삭제
// → 각각 deleteOption = 'single'
// → 나머지 이벤트 영향 없음
```

---

## ✅ 검증 계획

### 1. 기존 테스트 회귀 검증

**실행**:

```bash
pnpm test src/__tests__/medium.integration.spec.tsx -t "작업 015"
```

**기대 결과**:

- ✅ TC-001~TC-008: 8/8 통과
- ✅ 다이얼로그 UI 정상 작동
- ✅ 버튼 클릭 시 다이얼로그 닫힘

### 2. 전체 테스트 회귀 검증

**실행**:

```bash
pnpm test
```

**기대 결과**:

- ✅ 191/191 통과
- ✅ Linter 에러 없음

---

## 🧪 추가 테스트 (선택적)

만약 더 명확한 검증이 필요하면, `useEventOperations` 테스트에 다음을 추가할 수 있습니다:

### useEventOperations 단위 테스트 (선택)

```typescript
describe('작업 016: 반복 일정 단일 삭제', () => {
  it('deleteOption이 single일 때 단일 이벤트만 삭제된다', async () => {
    // Arrange: deleteOption = 'single'로 hook 초기화
    // Act: deleteEvent(id) 호출
    // Assert: DELETE /api/events/{id} 1번만 호출
  });
});
```

**권장 사항**: 작업 015의 테스트로 충분하므로 생략 가능

---

## 📊 테스트 커버리지

### 작업 015에서 이미 커버된 시나리오

| 시나리오                    | 테스트 케이스 | 상태 |
| --------------------------- | ------------- | ---- |
| 단일 이벤트 삭제            | TC-001        | ✅   |
| 반복 이벤트 삭제 다이얼로그 | TC-002        | ✅   |
| "이 일정만" 클릭            | TC-003        | ✅   |
| "전체 반복" 클릭            | TC-004        | ✅   |
| "취소" 클릭                 | TC-005        | ✅   |
| ESC 키                      | TC-006        | ✅   |
| 여러 번 단일 삭제           | TC-007        | ✅   |
| 혼합 시나리오               | TC-008        | ✅   |

### 작업 016에서 추가로 확인할 사항

- [ ] `deleteOption`이 `useEventOperations`에 전달되는가?
- [ ] Linter 에러 없는가?
- [ ] 기존 테스트 모두 통과하는가?

---

## 🎯 성공 기준

### 필수 조건

1. ✅ 작업 015의 8개 테스트 모두 통과
2. ✅ 전체 191개 테스트 통과
3. ✅ Linter 에러 없음
4. ✅ TypeScript 타입 에러 없음

### 선택 조건

- 추가 테스트 작성 (필요시)

---

## 📝 구현 가이드

### RED 단계

- **새 테스트 없음** (작업 015의 테스트 활용)
- 기존 테스트가 통과하는지만 확인

### GREEN 단계

1. `useEventOperations`에 `deleteOption` 매개변수 추가
2. `App.tsx`에서 `deleteOption` 전달
3. 기존 테스트 통과 확인

### REFACTOR 단계

- 필요시 주석 추가
- eslint-disable 정리

---

## 🔗 관련 문서

- 작업 015 명세: `docs/specs/015-delete-repeat-confirm-dialog.md`
- 작업 015 테스트: `docs/specs/015-test-design.md`
- 작업 013/014: `editOption` 참고 패턴

---

## 💡 핵심 인사이트

**"단일 삭제는 기존 로직을 그대로 사용"**

- 반복 일정의 각 인스턴스는 독립적인 `id`를 가짐
- 단일 삭제 = 일반 삭제와 동일
- `DELETE /api/events/{id}` 1번 호출로 충분
- 작업 017에서만 `repeatParentId` 기반 일괄 삭제 추가 예정

따라서 **매우 간단한 작업**입니다! (복잡도 1/5)

