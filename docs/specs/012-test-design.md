# 테스트 설계: 반복 일정 수정 확인 다이얼로그 UI (작업 012)

## 📋 개요

**테스트 대상**: Edit 버튼 클릭 시 다이얼로그 표시 로직 및 버튼 이벤트
**테스트 파일**: `src/__tests__/medium.integration.spec.tsx` (기존 파일에 추가)
**테스트 프레임워크**: Vitest + React Testing Library

---

## 🎯 테스트 목표

1. **다이얼로그 표시 조건**: repeatParentId가 있을 때만 표시
2. **다이얼로그 버튼**: 3개 버튼 모두 작동
3. **상태 관리**: 버튼 클릭 시 상태 변경
4. **단일 이벤트**: repeatParentId 없으면 다이얼로그 스킵

---

## 📝 테스트 케이스 설계

### 테스트 그룹 1: 다이얼로그 표시 조건

#### TC-001: 단일 이벤트 Edit 클릭 - 다이얼로그 안 보임

```
설명: repeatParentId가 없는 이벤트의 Edit 버튼 클릭
입력:
  - 이벤트: { id: '1', repeatParentId: undefined, ... }
  - 클릭: Edit 버튼
예상 결과:
  - 다이얼로그 렌더링 안 됨
  - 바로 수정 폼이 열려야 함 (현재는 미구현, 나중 작업)
검증:
  - queryByRole('dialog', { name: /반복 일정 수정/ }) === null
```

#### TC-002: 반복 이벤트 Edit 클릭 - 다이얼로그 표시

```
설명: repeatParentId가 있는 이벤트의 Edit 버튼 클릭
입력:
  - 이벤트: { id: '1', repeatParentId: 'parent-123', ... }
  - 클릭: Edit 버튼
예상 결과:
  - 다이얼로그 렌더링됨
  - 제목: "반복 일정 수정"
  - 메시지: "해당 일정만 수정하시겠어요?"
  - 3개 버튼: "이 일정만", "전체 반복", "취소"
검증:
  - getByRole('dialog', { name: /반복 일정 수정/ }) 존재
  - getByText('해당 일정만 수정하시겠어요?') 존재
  - 3개 버튼 모두 존재
```

---

### 테스트 그룹 2: 다이얼로그 버튼 클릭

#### TC-003: "이 일정만" 버튼 클릭

```
설명: "이 일정만" 버튼을 클릭하면 상태 업데이트
입력:
  - 다이얼로그: 표시됨
  - 클릭: "이 일정만" 버튼
예상 결과:
  - editOption 상태가 'single'으로 설정
  - 다이얼로그 닫힘
  - 수정 폼 열림 (또는 handleEdit 함수 호출)
검증:
  - queryByRole('dialog') === null (다이얼로그 닫힘)
  - 또는 수정 폼 관련 요소 표시 여부
```

#### TC-004: "전체 반복" 버튼 클릭

```
설명: "전체 반복" 버튼을 클릭하면 상태 업데이트
입력:
  - 다이얼로그: 표시됨
  - 클릭: "전체 반복" 버튼
예상 결과:
  - editOption 상태가 'all'로 설정
  - 다이얼로그 닫힘
  - 수정 폼 열림
검증:
  - queryByRole('dialog') === null (다이얼로그 닫힘)
  - 또는 수정 폼 관련 요소 표시 여부
```

#### TC-005: "취소" 버튼 클릭

```
설명: "취소" 버튼을 클릭하면 다이얼로그만 닫힘
입력:
  - 다이얼로그: 표시됨
  - 클릭: "취소" 버튼
예상 결과:
  - editOption 상태 그대로 (null)
  - 다이얼로그 닫힘
  - 아무 액션도 일어나지 않음
검증:
  - queryByRole('dialog') === null (다이얼로그 닫힘)
  - 수정 폼 열리지 않음
```

---

### 테스트 그룹 3: 다이얼로그 콘텐츠

#### TC-006: 다이얼로그 제목 확인

```
설명: 다이얼로그 제목이 올바르게 표시
입력:
  - 다이얼로그: 표시됨
예상 결과:
  - 제목: "반복 일정 수정"
검증:
  - getByRole('heading', { name: /반복 일정 수정/ }) 존재
```

#### TC-007: 다이얼로그 메시지 확인

```
설명: 다이얼로그 메시지가 명확함
입력:
  - 다이얼로그: 표시됨
예상 결과:
  - 메시지: "해당 일정만 수정하시겠어요?"
검증:
  - getByText(/해당 일정만 수정하시겠어요/) 존재
```

#### TC-008: 다이얼로그 버튼 텍스트 확인

```
설명: 3개 버튼 모두 올바른 텍스트 표시
입력:
  - 다이얼로그: 표시됨
예상 결과:
  - 버튼 1: "이 일정만"
  - 버튼 2: "전체 반복"
  - 버튼 3: "취소"
검증:
  - getByRole('button', { name: /이 일정만/ }) 존재
  - getByRole('button', { name: /전체 반복/ }) 존재
  - getByRole('button', { name: /취소/ }) 존재
```

---

### 테스트 그룹 4: 다이얼로그 상태

#### TC-009: 다이얼로그 초기 상태 (안 보임)

```
설명: 앱 처음 렌더링 시 다이얼로그 안 보임
입력:
  - 앱 렌더링
예상 결과:
  - 다이얼로그 요소 없음
검증:
  - queryByRole('dialog', { name: /반복 일정 수정/ }) === null
```

#### TC-010: 여러 번 Edit 클릭

```
설명: Edit 버튼을 여러 번 클릭해도 다이얼로그 정상 작동
입력:
  - Edit 버튼 클릭 → "취소" 클릭 → Edit 버튼 클릭 → "이 일정만" 클릭
예상 결과:
  - 매번 다이얼로그 정상 표시/숨김
  - 상태 정상 업데이트
검증:
  - 반복해도 에러 없음
  - 상태 일관성 유지
```

---

## 🔧 테스트 작성 전략

### AAA 패턴 (Arrange, Act, Assert)

```typescript
it('TC-002: 반복 이벤트 Edit 클릭 - 다이얼로그 표시', async () => {
  // Arrange: 반복 이벤트와 렌더링
  const repeatEvent = {
    id: '1',
    title: '반복 회의',
    repeatParentId: 'parent-123',
    // ... 나머지 필드
  };

  render(<App />);

  // Act: Edit 버튼 클릭
  const editButton = screen.getByRole('button', { name: /edit/i });
  await userEvent.click(editButton);

  // Assert: 다이얼로그 표시 확인
  expect(screen.getByRole('dialog', { name: /반복 일정 수정/ })).toBeInTheDocument();
  expect(screen.getByText(/해당 일정만 수정하시겠어요/)).toBeInTheDocument();
});
```

### Mock/Setup

```typescript
// Dialog 열기/닫기 상태는 App.tsx의 useState로 관리
// userEvent.click으로 버튼 클릭 시뮬레이션
// 상태 변경은 DOM 업데이트로 검증
```

---

## ✅ 검증 포인트

### 다이얼로그 렌더링

- [ ] repeatParentId 없으면 안 보임
- [ ] repeatParentId 있으면 보임
- [ ] 제목, 메시지, 버튼 모두 표시

### 버튼 기능

- [ ] "이 일정만" 클릭 시 상태 'single'
- [ ] "전체 반복" 클릭 시 상태 'all'
- [ ] "취소" 클릭 시 상태 null 유지

### 상태 관리

- [ ] 다이얼로그 열기/닫기 상태 정상
- [ ] 선택 옵션 저장됨
- [ ] 여러 번 클릭해도 정상

### UI 요소

- [ ] 다이얼로그 제목 정확
- [ ] 다이얼로그 메시지 명확
- [ ] 3개 버튼 모두 작동

---

## 📌 테스트 작성 순서

1. **TC-001**: 단일 이벤트 - 다이얼로그 안 보임 (기본)
2. **TC-002**: 반복 이벤트 - 다이얼로그 보임 (핵심) ⭐
3. **TC-006**: 제목 확인
4. **TC-007**: 메시지 확인
5. **TC-003**: "이 일정만" 클릭 (기능) ⭐
6. **TC-004**: "전체 반복" 클릭 (기능) ⭐
7. **TC-005**: "취소" 클릭
8. **나머지**: 추가 검증

---

## 🎯 테스트 체크리스트

- [ ] 모든 테스트 케이스 작성
- [ ] AAA 패턴 적용
- [ ] Edit 버튼 클릭 시뮬레이션
- [ ] 다이얼로그 버튼 클릭 시뮬레이션
- [ ] 상태 변경 검증
- [ ] 여러 번 클릭 테스트
- [ ] 에러 케이스 없음
