# ëª…ì„¸: saveEventì— ë°˜ë³µ ìƒì„± ë¡œì§ í†µí•© (ì‘ì—… 008)

## ğŸ“‹ ê°œìš”

**ì‘ì—…**: ë°˜ë³µ ì¼ì •ì´ ì„¤ì •ëœ ê²½ìš°, ê°œë³„ ì´ë²¤íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ë¡œì§ êµ¬í˜„
**ëª©ì **: ì‚¬ìš©ìê°€ ë°˜ë³µ ì¼ì •ì„ ì„¤ì •í•˜ê³  ì €ì¥í•  ë•Œ, `generateRecurringEvents()` í•¨ìˆ˜ë¡œ ì—¬ëŸ¬ ì´ë²¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ê°œë³„ì ìœ¼ë¡œ APIì— ì €ì¥
**ì˜í–¥ ë²”ìœ„**: `src/hooks/useEventOperations.ts`ì˜ `saveEvent` í•¨ìˆ˜ ìˆ˜ì •

---

## ğŸ“ ìš”êµ¬ì‚¬í•­

### ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

1. **ë°˜ë³µ ìƒì„± ë¡œì§ í†µí•©**

   - `saveEvent` í•¨ìˆ˜ê°€ í˜¸ì¶œë  ë•Œ, ë‹¨ì¼ ì €ì¥ ëª¨ë“œê°€ ì•„ë‹Œ ê²½ìš°:
   - `repeat.type !== 'none'` ê²€ì‚¬
   - ì¡°ê±´ ë§Œì¡± ì‹œ `generateRecurringEvents(eventData)` í˜¸ì¶œ
   - ë°˜í™˜ëœ ì´ë²¤íŠ¸ ë°°ì—´ì˜ ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ APIì— ì €ì¥

2. **ìˆœì°¨ ì €ì¥ ì²˜ë¦¬**

   - ì—¬ëŸ¬ ì´ë²¤íŠ¸ë¥¼ ëª¨ë‘ ì €ì¥í•˜ê¸° ì „ì— ëª¨ë“  ì €ì¥ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
   - í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì—ëŸ¬ ì²˜ë¦¬
   - ì„±ê³µ ì‹œ ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ í¬í•¨í•œ `fetchEvents()` í˜¸ì¶œ

3. **ê¸°ì¡´ ìˆ˜ì • ëª¨ë“œ ìœ ì§€**
   - ê¸°ì¡´ ì´ë²¤íŠ¸ ìˆ˜ì • ì‹œ (`editing === true`): ë°˜ë³µ ìƒì„± ë¡œì§ ë¯¸ì ìš©
   - ë‹¨ì¼ ì´ë²¤íŠ¸ ìˆ˜ì •ë§Œ ìˆ˜í–‰

### ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

- ì„±ëŠ¥: 10ê°œ ì´ë‚´ì˜ ì´ë²¤íŠ¸ëŠ” ~1ì´ˆ ë‚´ ì™„ë£Œ
- ì•ˆì •ì„±: ë¶€ë¶„ ì‹¤íŒ¨ ì‹œì—ë„ ì™„ì „íˆ ì‹¤íŒ¨í•´ì•¼ í•¨ (íŠ¸ëœì­ì…˜ ê°œë…)
- UX: ì €ì¥ ì¤‘ ìŠ¤ë‚µë°” í‘œì‹œ, ì™„ë£Œ í›„ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ

---

## ğŸ¯ ì˜í–¥ ë²”ìœ„

### ìˆ˜ì •í•  íŒŒì¼

- `src/hooks/useEventOperations.ts`
  - í•¨ìˆ˜: `saveEvent`
  - ë³€ê²½ ì‚¬í•­: ë°˜ë³µ ìƒì„± ë¡œì§ ì¶”ê°€

### í•„ìš”í•œ import

- `generateRecurringEvents` from `../utils/recurringEventUtils`

### ê¸°ì¡´ ì½”ë“œ í™œìš©

- `generateRecurringEvents()`: ì´ë¯¸ êµ¬í˜„ë¨ (ì‘ì—… 001-004 ì™„ë£Œ)
- API ì—”ë“œí¬ì¸íŠ¸: `/api/events` (POST), ì´ë¯¸ ì‘ë™ ì¤‘
- ìŠ¤ë‚µë°”: ì´ë¯¸ êµ¬í˜„ë¨

---

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### ì…ë ¥ê°’ (eventData)

```typescript
// í˜„ì¬ saveEvent í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜
eventData: Event | EventForm;

// EventForm íƒ€ì… (ë°˜ë³µ ì •ë³´ í¬í•¨)
interface EventForm {
  title: string;
  date: string; // YYYY-MM-DD
  startTime: string; // HH:MM
  endTime: string; // HH:MM
  repeat: RepeatInfo; // { type, interval, endDate, id }
  // ...
}

// RepeatInfo íƒ€ì…
interface RepeatInfo {
  type: RepeatType; // 'none' | 'daily' | 'weekly' | 'monthly' | 'yearly'
  interval: number;
  endDate?: string; // YYYY-MM-DD
  id?: string;
}
```

### ì¶œë ¥ê°’ (ìƒì„±ë  ì´ë²¤íŠ¸ë“¤)

```typescript
// generateRecurringEvents() ë°˜í™˜ê°’
Event[] // ì˜ˆ: [
        //   { ...baseEvent, id: 'uuid1', date: '2025-01-15', repeatParentId: 'parent1' },
        //   { ...baseEvent, id: 'uuid2', date: '2025-01-22', repeatParentId: 'parent1' },
        //   { ...baseEvent, id: 'uuid3', date: '2025-01-29', repeatParentId: 'parent1' },
        // ]
```

---

## ğŸ”§ API ëª…ì„¸

### ê¸°ì¡´ API (ë³€ê²½ ì—†ìŒ)

**POST /api/events**

```json
Request:
{
  "title": "ì¼ì •ëª…",
  "date": "2025-01-15",
  "startTime": "10:00",
  "endTime": "11:00",
  "repeat": { "type": "none", "interval": 1 },
  ...
}

Response:
{
  "id": "event-uuid",
  "title": "ì¼ì •ëª…",
  ...
}
```

**PUT /api/events/:id**

```json
Request: ê°™ìŒ (ìˆ˜ì •í•  ì´ë²¤íŠ¸ ë°ì´í„°)
Response: ê°™ìŒ
```

---

## ğŸš¨ ì—£ì§€ ì¼€ì´ìŠ¤

### 1. ë°˜ë³µ ì—†ìŒ (repeat.type === 'none')

- í˜„ì¬ ë™ì‘: ë‹¨ì¼ ì´ë²¤íŠ¸ë§Œ ì €ì¥
- ì˜ˆìƒ ê²°ê³¼: âœ… ë³€ê²½ ì—†ìŒ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)

### 2. ë°˜ë³µ ìˆìŒ (repeat.type !== 'none')

- í˜„ì¬ ë™ì‘: ë‹¨ì¼ ì´ë²¤íŠ¸ë§Œ ì €ì¥ â†’ âŒ ë²„ê·¸
- ì˜ˆìƒ ê²°ê³¼: âœ… ì—¬ëŸ¬ ì´ë²¤íŠ¸ ìƒì„± ë° ì €ì¥

### 3. ìˆ˜ì • ëª¨ë“œ (editing === true)

- í˜„ì¬ ë™ì‘: ë‹¨ì¼ ì´ë²¤íŠ¸ ìˆ˜ì •
- ì˜ˆìƒ ê²°ê³¼: âœ… ë³€ê²½ ì—†ìŒ (ë°˜ë³µ ìƒì„± ë¡œì§ ë¯¸ì ìš©)
- ì´ìœ : ë°˜ë³µ ì¼ì • ìˆ˜ì •ì€ ë³„ë„ ì‘ì—… (ì‘ì—… 012-014)ì—ì„œ ì²˜ë¦¬

### 4. API ì €ì¥ ì‹¤íŒ¨ (ë¶€ë¶„ ì‹¤íŒ¨)

- ì˜ˆ: ì²« 3ê°œ ì €ì¥ ì„±ê³µ, 4ë²ˆì§¸ ì‹¤íŒ¨
- í˜„ì¬ ë™ì‘: ë¶€ë¶„ ì €ì¥ë¨ â†’ âŒ ë°ì´í„° ë¶ˆì¼ì¹˜
- ì˜ˆìƒ ê²°ê³¼: âœ… ëª¨ë“  ì €ì¥ ì‹œë„ í›„ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ë¡¤ë°± ë˜ëŠ” ì™„ì „ ì‹¤íŒ¨

### 5. ë°˜ë³µ ì¼ì • ê°œìˆ˜ê°€ ë§ì€ ê²½ìš°

- ì˜ˆ: 1ë…„ ë§¤ì¼ ë°˜ë³µ (365ê°œ ì´ë²¤íŠ¸)
- ì˜ˆìƒ ê²°ê³¼: âœ… ëª¨ë‘ ì €ì¥ (ì„±ëŠ¥ ìµœì í™”ëŠ” ì‘ì—… ë²”ìœ„ ì•„ë‹˜)

---

## âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ë°˜ë³µ ì—†ëŠ” ë‹¨ì¼ ì´ë²¤íŠ¸ ì €ì¥

- **ì…ë ¥**: `repeat.type === 'none'`ì¸ EventForm
- **ì˜ˆìƒ**: ë‹¨ì¼ ì´ë²¤íŠ¸ 1ê°œ ì €ì¥, API í˜¸ì¶œ 1íšŒ
- **ê²€ì¦**: snackbar ë©”ì‹œì§€ "ì¼ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë°˜ë³µ ì¼ì • ì €ì¥ (ë§¤ì£¼ 3íšŒ)

- **ì…ë ¥**:
  - date: '2025-01-15' (ìˆ˜ìš”ì¼)
  - repeat: { type: 'weekly', interval: 1, endDate: '2025-02-05' }
- **ì˜ˆìƒ**:
  - ìƒì„±ë  ì´ë²¤íŠ¸: 2025-01-15, 01-22, 01-29, 02-05 (4ê°œ)
  - ê° ì´ë²¤íŠ¸ëŠ” ê°™ì€ `repeatParentId` ë³´ìœ 
  - API í˜¸ì¶œ: 4íšŒ
- **ê²€ì¦**:
  - ëª¨ë‘ ì €ì¥ë¨
  - `fetchEvents()` í˜¸ì¶œ í›„ 4ê°œ ì´ë²¤íŠ¸ ë¡œë“œ
  - snackbar ë©”ì‹œì§€ "ì¼ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë°˜ë³µ ì¼ì • ì €ì¥ ì¤‘ API ì˜¤ë¥˜ (2ê°œ ì¤‘ 1ê°œ ì‹¤íŒ¨)

- **ì…ë ¥**: 2ê°œ ì´ë²¤íŠ¸ ìƒì„±ë˜ëŠ” ë°˜ë³µ ì„¤ì •
- **ì˜ˆìƒ**:
  - 1ë²ˆì§¸ ì €ì¥ ì„±ê³µ
  - 2ë²ˆì§¸ ì €ì¥ ì‹¤íŒ¨
  - snackbar ì—ëŸ¬ ë©”ì‹œì§€ "ì¼ì • ì €ì¥ ì‹¤íŒ¨"
- **ê²€ì¦**: ë¡œê·¸ì— ì—ëŸ¬ ê¸°ë¡

### ì‹œë‚˜ë¦¬ì˜¤ 4: ìˆ˜ì • ëª¨ë“œ (editing === true)

- **ì…ë ¥**:
  - editing: true
  - repeat.type !== 'none'ì¸ ì´ë²¤íŠ¸
- **ì˜ˆìƒ**:
  - ë°˜ë³µ ìƒì„± ë¡œì§ ë¯¸ì ìš©
  - ë‹¨ì¼ ì´ë²¤íŠ¸ë§Œ ìˆ˜ì • (PUT /api/events/:id)
  - API í˜¸ì¶œ: 1íšŒ
- **ê²€ì¦**: snackbar ë©”ì‹œì§€ "ì¼ì •ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."

---

## ğŸ”„ êµ¬í˜„ íë¦„

```
saveEvent í•¨ìˆ˜ í˜¸ì¶œ
  â†“
editing === false í™•ì¸
  â”œâ”€ true (ìˆ˜ì • ëª¨ë“œ) â†’ ê¸°ì¡´ ë¡œì§: PUT í˜¸ì¶œ
  â””â”€ false (ì‹ ê·œ ìƒì„±)
     â†“
     repeat.type === 'none' í™•ì¸
     â”œâ”€ true (ë‹¨ì¼ ì´ë²¤íŠ¸) â†’ ê¸°ì¡´ ë¡œì§: 1ê°œ POST í˜¸ì¶œ
     â””â”€ false (ë°˜ë³µ ì´ë²¤íŠ¸)
        â†“
        generateRecurringEvents(eventData) í˜¸ì¶œ
        â†“
        events ë°°ì—´ ë°›ìŒ
        â†“
        ëª¨ë“  eventsì— ëŒ€í•´ ìˆœì°¨ì ìœ¼ë¡œ POST í˜¸ì¶œ
        â†“
        ëª¨ë‘ ì„±ê³µ â†’ fetchEvents() â†’ snackbar ì„±ê³µ ë©”ì‹œì§€
        ì‹¤íŒ¨ â†’ snackbar ì—ëŸ¬ ë©”ì‹œì§€
```

---

## ğŸ“Œ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `saveEvent` í•¨ìˆ˜ ìˆ˜ì •
- [ ] `generateRecurringEvents` import ì¶”ê°€
- [ ] `editing === false && repeat.type !== 'none'` ì¡°ê±´ ì¶”ê°€
- [ ] ì—¬ëŸ¬ ì´ë²¤íŠ¸ ìˆœì°¨ ì €ì¥ ë¡œì§ êµ¬í˜„
- [ ] ì—ëŸ¬ ì²˜ë¦¬ (í•˜ë‚˜ ì‹¤íŒ¨ ì‹œ ëª¨ë‘ ì‹¤íŒ¨)
- [ ] í…ŒìŠ¤íŠ¸ ì‘ì„± ë° í†µê³¼
- [ ] ë¦°íŠ¸ í†µê³¼
